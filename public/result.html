<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>תוצאת ההרשמה - Botomat</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Heebo:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <div class="card" id="resultCard">
            <!-- Success State -->
            <div id="successState" class="result-state" style="display: none;">
                <div class="result-icon success">
                    <svg width="80" height="80" viewBox="0 0 80 80" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <circle cx="40" cy="40" r="40" fill="#10B981"/>
                        <path d="M25 40L35 50L55 30" stroke="white" stroke-width="4" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                </div>
                <h1>ההרשמה הושלמה בהצלחה!</h1>
                <p class="result-message">החשבון שלך חובר בהצלחה לשירות אנשי הקשר של Google.</p>
                <div class="user-info" id="userInfo"></div>
                <a href="/" class="btn-back">חזרה לדף הבית</a>
            </div>
            
            <!-- Error State -->
            <div id="errorState" class="result-state" style="display: none;">
                <div class="result-icon error">
                    <svg width="80" height="80" viewBox="0 0 80 80" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <circle cx="40" cy="40" r="40" fill="#EF4444"/>
                        <path d="M28 28L52 52M52 28L28 52" stroke="white" stroke-width="4" stroke-linecap="round"/>
                    </svg>
                </div>
                <h1>אופס! משהו השתבש</h1>
                <p class="result-message" id="errorMessage">ההתחברות נכשלה. אנא נסה שוב.</p>
                <a href="/" class="btn-back">נסה שוב</a>
            </div>
            
            <!-- Loading State -->
            <div id="loadingState" class="result-state">
                <div class="loader"></div>
                <h1>מעבד את הבקשה...</h1>
                <p class="result-message">אנא המתן</p>
            </div>
        </div>
    </div>

    <script>
        // Parse URL parameters
        function getUrlParams() {
            const params = new URLSearchParams(window.location.search);
            return {
                success: params.get('success'),
                error: params.get('error'),
                message: params.get('message'),
                email: params.get('email'),
                name: params.get('name')
            };
        }

        // Show result
        function showResult() {
            const params = getUrlParams();
            const loadingState = document.getElementById('loadingState');
            const successState = document.getElementById('successState');
            const errorState = document.getElementById('errorState');
            const userInfo = document.getElementById('userInfo');
            const errorMessage = document.getElementById('errorMessage');
            
            loadingState.style.display = 'none';
            
            if (params.success === 'true') {
                successState.style.display = 'block';
                
                let infoHtml = '';
                if (params.name) {
                    infoHtml += `<p><strong>שם:</strong> ${params.name}</p>`;
                }
                if (params.email) {
                    infoHtml += `<p><strong>אימייל:</strong> ${params.email}</p>`;
                }
                
                if (infoHtml) {
                    userInfo.innerHTML = infoHtml;
                } else {
                    userInfo.style.display = 'none';
                }
            } else {
                errorState.style.display = 'block';
                
                const errorMessages = {
                    'access_denied': 'הגישה נדחתה. אנא אשר את ההרשאות הנדרשות.',
                    'invalid_request': 'הבקשה לא תקינה. אנא נסה שוב.',
                    'no_code': 'לא התקבל קוד אימות מגוגל.',
                    'oauth_error': 'שגיאה בתהליך ההתחברות.',
                    'database_error': 'שגיאה בשמירת הנתונים.',
                    'server_error': 'שגיאת שרת. אנא נסה שוב מאוחר יותר.'
                };
                
                let msg = errorMessages[params.error] || params.error || 'שגיאה לא ידועה';
                if (params.message) {
                    msg += `: ${params.message}`;
                }
                errorMessage.textContent = msg;
            }
        }

        document.addEventListener('DOMContentLoaded', showResult);
    </script>
</body>
</html>
