<!DOCTYPE html>
<html dir="rtl" lang="he">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>×ª×•×¦××ª ×”×”×¨×©××” - Botomat</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Heebo:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <div class="card" id="resultCard">
            <!-- Success State -->
            <div id="successState" class="result-state" style="display: none;">
                <div class="result-icon">
                    <svg width="80" height="80" viewBox="0 0 80 80" fill="none">
                        <circle cx="40" cy="40" r="40" fill="#10B981"/>
                        <path d="M25 40L35 50L55 30" stroke="white" stroke-width="4" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                </div>
                <h2>âœ… ×”×ª×”×œ×™×š ×”×•×©×œ× ×‘×”×¦×œ×—×”!</h2>
                <p class="result-message">×”×ª×—×‘×¨×ª ×‘×”×¦×œ×—×” ×œ×’×•×’×œ ×•×”×¤×¨×˜×™× × ×©××¨×• ×‘××¢×¨×›×ª</p>
                <div class="user-info" id="userInfo"></div>
                <div class="info-box success">
                    <p>âœ¨ <strong>×¡×™×™×× ×•!</strong> ×›×œ ×”× ×ª×•× ×™× × ×©××¨×• ×•×”×ª×”×œ×™×š ×”×•×©×œ× ×‘××œ×•××•</p>
                </div>
                <p style="text-align: center; color: var(--text-light); margin-top: 1.5rem;">×ª×•×“×” ×¨×‘×” ×¢×œ ×”×©×™××•×© ×‘×©×™×¨×•×ª! ğŸ’š</p>
            </div>
            
            <!-- Error State -->
            <div id="errorState" class="result-state" style="display: none;">
                <div class="result-icon">
                    <svg width="80" height="80" viewBox="0 0 80 80" fill="none">
                        <circle cx="40" cy="40" r="40" fill="#EF4444"/>
                        <path d="M28 28L52 52M52 28L28 52" stroke="white" stroke-width="4" stroke-linecap="round"/>
                    </svg>
                </div>
                <h2>××•×¤×¡! ××©×”×• ×”×©×ª×‘×©</h2>
                <p class="result-message" id="errorMessage">×”×”×ª×—×‘×¨×•×ª × ×›×©×œ×”. ×× × × ×¡×” ×©×•×‘.</p>
                <div class="info-box">
                    <p>ğŸ’¡ <strong>×˜×™×¤:</strong> ×•×“× ×©××™×©×¨×ª ××ª ×›×œ ×”×”×¨×©××•×ª ×”× ×“×¨×©×•×ª ×‘×¢×ª ×”×”×ª×—×‘×¨×•×ª ×œ×’×•×’×œ</p>
                </div>
                <div style="text-align: center; margin-top: 1.5rem;">
                    <a href="/" class="btn-back">× ×¡×” ×©×•×‘</a>
                </div>
            </div>
            
            <!-- Loading State -->
            <div id="loadingState" class="result-state">
                <div class="loader"></div>
                <h2>××¢×‘×“ ××ª ×”×‘×§×©×”...</h2>
                <p class="result-message">×× × ×”××ª×Ÿ, ×–×” ×™×™×§×— ×¨×§ ×›××” ×©× ×™×•×ª</p>
            </div>
        </div>
    </div>

    <script>
        function getUrlParams() {
            const params = new URLSearchParams(window.location.search);
            return {
                success: params.get('success'),
                error: params.get('error'),
                message: params.get('message'),
                email: params.get('email'),
                name: params.get('name')
            };
        }

        function showResult() {
            const params = getUrlParams();
            const loadingState = document.getElementById('loadingState');
            const successState = document.getElementById('successState');
            const errorState = document.getElementById('errorState');
            const userInfo = document.getElementById('userInfo');
            const errorMessage = document.getElementById('errorMessage');
            
            // Small delay for better UX
            setTimeout(() => {
                loadingState.style.display = 'none';
                
                if (params.success === 'true') {
                    successState.style.display = 'block';
                    
                    let infoHtml = '';
                    if (params.name) {
                        infoHtml += `<p><strong>×©×:</strong> ${decodeURIComponent(params.name)}</p>`;
                    }
                    if (params.email) {
                        infoHtml += `<p><strong>××™××™×™×œ:</strong> ${decodeURIComponent(params.email)}</p>`;
                    }
                    
                    if (infoHtml) {
                        userInfo.innerHTML = infoHtml;
                        userInfo.style.display = 'block';
                    } else {
                        userInfo.style.display = 'none';
                    }
                } else {
                    errorState.style.display = 'block';
                    
                    const errorMessages = {
                        'access_denied': '×”×’×™×©×” × ×“×—×ª×”. ×× × ××©×¨ ××ª ×”×”×¨×©××•×ª ×”× ×“×¨×©×•×ª.',
                        'invalid_request': '×”×‘×§×©×” ×œ× ×ª×§×™× ×”. ×× × × ×¡×” ×©×•×‘.',
                        'no_code': '×œ× ×”×ª×§×‘×œ ×§×•×“ ××™××•×ª ××’×•×’×œ.',
                        'oauth_error': '×©×’×™××” ×‘×ª×”×œ×™×š ×”×”×ª×—×‘×¨×•×ª.',
                        'database_error': '×©×’×™××” ×‘×©××™×¨×ª ×”× ×ª×•× ×™×.',
                        'server_error': '×©×’×™××ª ×©×¨×ª. ×× × × ×¡×” ×©×•×‘ ×××•×—×¨ ×™×•×ª×¨.'
                    };
                    
                    let msg = errorMessages[params.error] || params.error || '×©×’×™××” ×œ× ×™×“×•×¢×”';
                    if (params.message) {
                        msg += `: ${decodeURIComponent(params.message)}`;
                    }
                    errorMessage.textContent = msg;
                }
            }, 800);
        }

        document.addEventListener('DOMContentLoaded', showResult);
    </script>
</body>
</html>
